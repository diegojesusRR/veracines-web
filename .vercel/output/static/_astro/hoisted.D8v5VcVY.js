import{$ as E,a as u}from"./hoisted.BJwJ80XN.js";import"./index.BXBeSuXa.js";const y="modulepreload",k=function(l){return"/"+l},v={},g=function(t,r,f){let e=Promise.resolve();if(r&&r.length>0){const o=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),d=n?.nonce||n?.getAttribute("nonce");e=Promise.all(r.map(s=>{if(s=k(s),s in v)return;v[s]=!0;const a=s.endsWith(".css"),L=a?'[rel="stylesheet"]':"";if(!!f)for(let c=o.length-1;c>=0;c--){const m=o[c];if(m.href===s&&(!a||m.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${L}`))return;const i=document.createElement("link");if(i.rel=a?"stylesheet":y,a||(i.as="script",i.crossOrigin=""),i.href=s,d&&i.setAttribute("nonce",d),document.head.appendChild(i),a)return new Promise((c,m)=>{i.addEventListener("load",c),i.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${s}`)))})}))}return e.then(()=>t()).catch(o=>{const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=o,window.dispatchEvent(n),!n.defaultPrevented)throw o})},{signIn:w}=await g(()=>import("./client.BqElmF-z.js"),[]),p=E("#login");p&&(p.onclick=()=>{w("twitch"),p.setAttribute("aria-disabled","true");const l=p.querySelector("span");l&&(l.innerText="Iniciando sesión...")});document.addEventListener("astro:page-load",()=>{u(".vote-team").forEach(t=>{const{combatId:r,voteId:f}=t.dataset,e=t.parentElement;t.onclick=()=>{let o;e&&(o=e.querySelector(".is-voted"),o?.classList.remove("is-voted")),t.classList.add("is-voted"),e&&t.className.includes("king-team")?(e.parentElement?.classList.remove("not-completed"),e.parentElement?.classList.add("completed")):(e.classList.remove("not-completed"),e.classList.add("completed"));const n=()=>{t.classList.remove("is-voted"),o?.classList.add("is-voted"),window.toast({title:"Error al guardar el voto",location:"bottom-center",dismissible:!1,type:"error",icon:!0})};fetch(`/api/votes/${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({voteId:f})}).then(d=>{if(!d.ok)return n();if(window.toast({title:"¡Voto registrado!",location:"bottom-center",dismissible:!1,type:"success",icon:!0}),u(".not-completed").length>0){const s=t.className.includes("king-team")?t.parentElement?.parentElement?.nextElementSibling:t.parentElement?.nextElementSibling;s?.className.includes("not-completed")&&s.scrollIntoView({behavior:"smooth"})}}).catch(()=>{n()})},t.className.includes("is-voted")&&(e&&t.className.includes("king-team")?(e.parentElement?.classList.remove("not-completed"),e.parentElement?.classList.add("completed")):(e.classList.remove("not-completed"),e.classList.add("completed")))})});const{signOut:_}=await g(()=>import("./client.BqElmF-z.js"),[]),h=E("#logout");h&&(h.onclick=()=>_());
